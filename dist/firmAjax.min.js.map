{"version":3,"file":"firmAjax.min.js","sources":["webpack://firmAjax/firmAjax.min.js"],"sourcesContent":["!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define([],t):\"object\"==typeof exports?exports.firmAjax=t():e.firmAjax=t()}(self,(function(){return(()=>{\"use strict\";var e={\"./lib/core/events.ts\":function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)\"default\"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,\"__esModule\",{value:!0});var i=function(){function e(){this.list=new Map}return e.prototype.has=function(e){return!!this.list.get(e)},e.prototype.on=function(e,t){var r=this.list.get(e);r&&r.push(t)||this.list.set(e,[t])},e.prototype.off=function(e,t){var r=this.list.get(e);r&&r.splice(r.indexOf(t)>>>0,1)},e.prototype.emit=function(e,t,r){return(this.list.get(e)||[]).slice().reduce((function(e,n){var o=n(e);return r?o:t}),t)},e}();o(r(\"./lib/types/index.ts\"),t),t.default=i},\"./lib/core/firmAjax.ts\":function(e,t,r){var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,\"__esModule\",{value:!0});var o=r(\"./lib/core/events.ts\"),i=r(\"./lib/helpers/merge.ts\"),s=r(\"./lib/handles/xhr.ts\"),u=function(){function e(e){this.timer=null,this.startTime=null,this.requestCount=0,this.firstResult=null,this.defaults=e,this.event=new o.default}return e.prototype.setPublicConfig=function(e){this.defaults=i.default(e,this.defaults)},e.prototype.use=function(e,t){this.event.on(e,t)},e.prototype.onSchedule=function(e){var t=e.url,r=e.type,n=r+\":\"+e.method+\"-\"+t,o=this.event.has(n);o&&this.event.emit(n,e),!o&&this.event.emit(r,e)},e.prototype.request=function(e){var t=this;return this.startTime||(this.startTime=Date.now(),this.firstResult=this.event.emit(\"firstRequest\",null,!0)),this.timer&&clearTimeout(this.timer),this.requestCount++,e=this.event.emit(\"beforeRequest\",e,!0),s.default(i.default(e,this.defaults),this.onSchedule.bind(this)).then((function(e){return e=t.event.emit(\"beforeResponse\",e,!0),Promise.resolve(e)})).catch((function(e){return e=t.event.emit(\"error\",e,!0),Promise.reject(e)})).finally((function(){t.requestCount--,t.requestCount||(t.timer=window.setTimeout((function(){var e=Date.now();t.event.emit(\"allRequestEnd\",{firstResult:t.firstResult,totalTime:e-t.startTime+20}),t.startTime=null}),20))}))},e.prototype.get=function(e,t){return this.request(n(n({},t),{method:\"get\",url:e}))},e.prototype.delete=function(e,t){return this.request(n(n({},t),{method:\"delete\",url:e}))},e.prototype.head=function(e,t){return this.request(n(n({},t),{method:\"head\",url:e}))},e.prototype.options=function(e,t){return this.request(n(n({},t),{method:\"options\",url:e}))},e.prototype.post=function(e,t,r){return this.request(n(n({},r),{method:\"post\",data:t,url:e}))},e.prototype.put=function(e,t,r){return this.request(n(n({},r),{method:\"put\",data:t,url:e}))},e.prototype.patch=function(e,t,r){return this.request(n(n({},r),{method:\"patch\",data:t,url:e}))},e}();t.default=u},\"./lib/handles/xhr.ts\":(e,t,r)=>{Object.defineProperty(t,\"__esModule\",{value:!0});var n=r(\"./lib/helpers/url.ts\"),o=r(\"./lib/helpers/createError.ts\"),i=r(\"./lib/helpers/data.ts\"),s=r(\"./lib/helpers/type.ts\"),u=r(\"./lib/helpers/cookies.ts\");t.default=function(e,t){var r=e.url,a=e.data,l=e.params,c=e.timeout,p=e.baseUrl,f=e.headers,d=void 0===f?{}:f,h=e.responseType,v=e.validateStatus,y=e.method,b=void 0===y?\"GET\":y,m=e.xsrfCookieName,g=e.xsrfHeaderName,j=e.withCredentials,O=e.isUploadProgress,_=e.isDownloadProgress;return new Promise((function(f,y){var x=new XMLHttpRequest;s.isFormData(a)&&delete d[\"Content-Type\"];var C=n.buildUrl(n.spliceUrl(p,r),l);if(x.open(b.toUpperCase(),C,!0),x.onreadystatechange=function(){if(x&&4===x.readyState&&(0!==x.status||x.responseURL&&0===x.responseURL.indexOf(\"file:\"))){var t={data:h&&\"text\"!==h?x.response:x.responseText,config:e,headers:d,request:x,status:x.status,statusText:x.statusText},r=v[0],n=v[1];x.status>=r&&x.status<n?f(t):y(o.default(\"Request failed with status code \"+x.status,e,x.status.toString(),x,t))}},c&&(x.timeout=c),h)try{x.responseType=e.responseType}catch(t){if(\"json\"!==e.responseType)throw t}var P=j&&m?u.getCookie(m):null;P&&(d[g]=P),j&&(x.withCredentials=j),Object.keys(d).forEach((function(e){void 0===typeof a&&\"content-type\"===e.toLowerCase()?delete d[e]:x.setRequestHeader(e,d[e])})),x.addEventListener(\"timeout\",(function(){y(o.default(\"Network Error\",e,null,x))})),x.addEventListener(\"error\",(function(){y(o.default(\"timeout of \"+e.timeout+\"ms exceeded\",e,null,x))})),_&&x.addEventListener(\"progress\",(function(e){var n=e.loaded,o=e.total;t({url:r,method:b,type:\"download\",schedule:n/o})})),O&&x.upload.addEventListener(\"progress\",(function(e){var n=e.loaded,o=e.total;t({url:r,method:b,type:\"upload\",schedule:n/o})})),x.send(i.transformRequest(a))}))}},\"./lib/helpers/cookies.ts\":(e,t,r)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.removeCookie=t.getCookie=t.setCookie=void 0;var n=r(\"./lib/helpers/type.ts\");function o(e,t,r){var o=r||{},i=o.expires,s=o.path,u=o.domain,a=o.secure,l=[];if(l.push(e+\"=\"+encodeURIComponent(t)),i){var c=null;if(n.isNumber(i)){var p=24*r.expires*60*60*1e3;(c=new Date).setTime(c.getTime()+p)}else c=i;l.push(\"expires=\"+c.toUTCString())}s&&n.isString(s)&&l.push(\"path=\"+s),u&&n.isString(u)&&l.push(\"domain=\"+u),a&&l.push(\"secure\"),document.cookie=l.join(\";\")}t.setCookie=o,t.getCookie=function(e){var t=new RegExp(\"(?:^|; )\"+encodeURIComponent(e)+\"=([^;]*)\").exec(document.cookie);return console.log(t),t?decodeURIComponent(t[1]):null},t.removeCookie=function(e){o(e,\"\",{expires:0})}},\"./lib/helpers/createError.ts\":function(e,t){var r,n=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,\"__esModule\",{value:!0});var o=function(e){function t(t,r,n,o,i){var s=e.call(this,t)||this;return s.code=n,s.config=r,s.request=o,s.response=i,s}return n(t,e),t}(Error);t.default=function(e,t,r,n,i){return new o(e,t,r,n,i)}},\"./lib/helpers/data.ts\":(e,t,r)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.transformRequest=void 0;var n=r(\"./lib/helpers/type.ts\");t.transformRequest=function(e){return n.isObject(e)&&!n.isFormData(e)&&(e=JSON.stringify(e)),e}},\"./lib/helpers/defaultConfig.ts\":(e,t)=>{Object.defineProperty(t,\"__esModule\",{value:!0});t.default={headers:{Accept:\"application/json, text/plain, */*\",\"Content-Type\":\"application/json; charset=utf-8\"},baseUrl:\"\",responseType:\"json\",validateStatus:[200,300],xsrfCookieName:\"XSRF-TOKEN\",xsrfHeaderName:\"X-XSRF-TOKEN\"}},\"./lib/helpers/headers.ts\":(e,t,r)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.normalizeHeaderName=void 0;var n=r(\"./lib/helpers/type.ts\");t.normalizeHeaderName=function(e,t){var r=n.isString(t)?[t]:t;Object.keys(e).forEach((function(t){var n=r.find((function(e){return t!==e&&t.toLowerCase()===e.toLowerCase()}));n&&(e[n]=e[t],delete e[t])}))}},\"./lib/helpers/merge.ts\":(e,t,r)=>{Object.defineProperty(t,\"__esModule\",{value:!0});var n=r(\"./lib/helpers/type.ts\"),o=r(\"./lib/helpers/headers.ts\");t.default=function e(t,r){return o.normalizeHeaderName(t,[\"Content-Type\",\"Accept\"]),Object.keys(r).forEach((function(o){var i=r[o];if(!t[o])return t[o]=i;n.isPlainObject(i)&&n.isPlainObject(t[o])&&e(t[o],i)})),t}},\"./lib/helpers/type.ts\":(e,t)=>{Object.defineProperty(t,\"__esModule\",{value:!0}),t.isString=t.isNumber=t.isFormData=t.isDate=t.isArray=t.isPlainObject=t.isObject=t.type=void 0;var r={}.toString;function n(e){var t=r.call(e),n=t.length;return t.slice(8,n-1).toLowerCase()}t.type=n,t.isObject=function(e){return null!==e&&\"object\"==typeof e},t.isPlainObject=function(e){return\"object\"===n(e)},t.isArray=function(e){return\"array\"===n(e)},t.isDate=function(e){return\"date\"===n(e)},t.isFormData=function(e){return\"formdata\"===n(e)},t.isNumber=function(e){return\"number\"===n(e)},t.isString=function(e){return\"string\"===n(e)}},\"./lib/helpers/url.ts\":function(e,t,r){var n=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],s=0,u=i.length;s<u;s++,o++)n[o]=i[s];return n};Object.defineProperty(t,\"__esModule\",{value:!0}),t.spliceUrl=t.buildUrl=void 0;var o=r(\"./lib/helpers/type.ts\");function i(e){return encodeURIComponent(e).replace(/%3A/gi,\":\").replace(/%24/g,\"$\").replace(/%2C/gi,\",\").replace(/%20/g,\"+\").replace(/%5B/gi,\"[\").replace(/%5D/gi,\"]\")}t.buildUrl=function(e,t){if(!t)return e;var r=Object.keys(t).reduce((function(e,r){var s=t[r];if(null==s)return e;o.isArray(s)?r+=\"[]\":s=[s];var u=s.map((function(e){return o.isDate(e)?e=e.toISOString():o.isPlainObject(e)&&(e=JSON.stringify(e)),i(r)+\"=\"+i(e)}));return n(e,u)}),[]).join(\"&\");if(r){var s=e.indexOf(\"#\");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf(\"?\")?\"?\":\"&\")+r}return e},t.spliceUrl=function(e,t){return(e+\"/\"+t).replace(/\\/+/g,\"/\").replace(/^http:\\//,\"http://\").replace(/^https:\\//,\"https://\")}},\"./lib/index.ts\":function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)\"default\"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,\"__esModule\",{value:!0});var i=r(\"./lib/core/firmAjax.ts\"),s=r(\"./lib/helpers/defaultConfig.ts\"),u=[\"use\",\"get\",\"put\",\"head\",\"post\",\"patch\",\"delete\",\"options\",\"request\",\"setPublicConfig\"];var a,l,c,p=(a=s.default,l=new i.default(a),c=i.default.prototype.request.bind(l),u.forEach((function(e){c[e]=i.default.prototype[e].bind(l)})),c);o(r(\"./lib/types/index.ts\"),t),t.default=p},\"./lib/types/index.ts\":(e,t)=>{Object.defineProperty(t,\"__esModule\",{value:!0})}},t={};return function r(n){if(t[n])return t[n].exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}(\"./lib/index.ts\")})()}));"],"mappings":";AAAA","sourceRoot":""}